---
title: "Opinion di pueblo"
output: html_notebook
---


```{r}
# Load necessary libraries
library(ggplot2)
library(tidyr)
library(dplyr)
```

```{r}
Responses...Opinion.di.pueblo...16.October.2024 <- read.csv("C:/Users/Rendell CE/OneDrive - Cornerstone Economics/Lovely Data/Opinion di pueblo/Responses - Opinion di pueblo - 16 October 2024.csv", stringsAsFactors=TRUE)

df<-Responses...Opinion.di.pueblo...16.October.2024

colnames(df)[24:34] <- paste0("rating_", 1:11)
colnames(df)[1] <- paste0("Eligble")

# Filter out rows where df$Eligible is "No"
df_filtered <- df %>%
  filter(Eligble != "No")
```

```{r}


# Create a named vector for custom labels (excluding rating_1 and rating_11)
custom_labels <- c(
  rating_2 = "Evelyna Wever-Croes",
  rating_3 = "Geoffrey Wever",
  rating_4 = "Ursell Arends",
  rating_5 = "Xiomara Maduro",
  rating_6 = "Rocco Tjon",
  rating_7 = "Glenbert Croes",
  rating_8 = "Dangui Oduber",
  rating_9 = "Endy Croes",
  rating_10 = "Ady Thijsen"
)

# Filter out rating_1 and rating_11 from the dataframe
df_filtered <- df_long %>%
  filter(!(Rating %in% c("rating_1", "rating_11")))

# Calculate means and reorder the Rating factor in ascending order
mean_order <- df_filtered %>%
  group_by(Rating) %>%
  summarise(mean_score = mean(Score, na.rm = TRUE)) %>%
  arrange(mean_score) %>%
  pull(Rating)

# Reorder the Rating factor in the filtered dataframe
df_filtered$Rating <- factor(df_filtered$Rating, levels = mean_order)

# Create the violin plot with custom labels and add the mean labels
ggplot(df_filtered, aes(x = Rating, y = Score)) +
  geom_violin(trim = FALSE, fill = "lightblue") +   # Violin plot with no trimming, and custom color
  geom_jitter(width = 0.2, alpha = 0.3) +           # Add jitter to show individual data points
  stat_summary(fun = "mean", geom = "point",        # Add points for the mean
               color = "red", size = 3) +           # Customize color and size of mean points
  # Calculate means dynamically within the plot
  stat_summary(fun = mean, geom = "text", aes(label = round(..y.., 1)),  # Add labels for means
               color = "black", vjust = -1.1) +     # Position labels slightly above the red dots
  coord_flip() +                                    # Flip the coordinates
  theme_minimal() +                                 # Use a minimal theme
  theme(panel.grid = element_blank()) +             # Remove grid lines
  labs(title = "Performance ratings",                           # Title for the plot
       y = "",
       x = "") +                                    # Y-axis label (flipped)
  scale_x_discrete(labels = custom_labels)          # Use custom labels for x-axis
```

